<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://www.cyanzoy.top</id>
    <title>MAOA-L</title>
    <updated>2019-10-24T06:35:18.255Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://www.cyanzoy.top"/>
    <link rel="self" href="https://www.cyanzoy.top/atom.xml"/>
    <subtitle>ä¸ºæŠ€æœ¯è€Œç”Ÿ</subtitle>
    <logo>https://www.cyanzoy.top/images/avatar.png</logo>
    <icon>https://www.cyanzoy.top/favicon.ico</icon>
    <rights>All rights reserved 2019, MAOA-L</rights>
    <entry>
        <title type="html"><![CDATA[å¤‡å¿˜å½•]]></title>
        <id>https://www.cyanzoy.top/post/fnyLymsmv</id>
        <link href="https://www.cyanzoy.top/post/fnyLymsmv">
        </link>
        <updated>2019-10-24T06:29:53.000Z</updated>
        <summary type="html"><![CDATA[<p>é¢„é˜²è€å¹´ç—´å‘†,äººäººæœ‰è´£</p>
]]></summary>
        <content type="html"><![CDATA[<p>é¢„é˜²è€å¹´ç—´å‘†,äººäººæœ‰è´£</p>
<!-- more -->
<h1 id="å…³äºæœåŠ¡å™¨é¡¹ç›®çš„ä¸€äº›å¤‡å¿˜">å…³äºæœåŠ¡å™¨é¡¹ç›®çš„ä¸€äº›å¤‡å¿˜</h1>
<p>é¡¹ç›®è™šæ‹Ÿç¯å¢ƒç»Ÿä¸€æ”¾åœ¨ /home/env/ ä¸‹<br>
è‡ªå®šä¹‰serviceæ”¾åœ¨ /usr/lib/systemd/system/ ç›®å½•ä¸‹<br>
è¿è¡Œè„šæœ¬æ”¾åœ¨/etc/init.d/ ç›®å½•ä¸‹</p>
<h1 id="å…³äºé¡¹ç›®ç¯å¢ƒçš„ä¸€äº›å¤‡å¿˜">å…³äºé¡¹ç›®ç¯å¢ƒçš„ä¸€äº›å¤‡å¿˜</h1>
<p>source è¿›å…¥pythonçš„è™šæ‹Ÿç¯å¢ƒåï¼Œç›´æ¥è¿è¡Œdeactivateé€€å‡ºè™šæ‹Ÿç¯å¢ƒ<br>
linuxå®‰è£…mysqlclientéœ€è¦ç¯å¢ƒmysql-devel</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Linuxæ€§èƒ½æµ‹è¯•]]></title>
        <id>https://www.cyanzoy.top/post/YQMzxqNFJ</id>
        <link href="https://www.cyanzoy.top/post/YQMzxqNFJ">
        </link>
        <updated>2019-10-15T06:32:01.000Z</updated>
        <summary type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥ https://blog.ilemonrain.com/linux/LemonBench.html</p>
]]></summary>
        <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥ https://blog.ilemonrain.com/linux/LemonBench.html</p>
<!-- more -->
<h1 id="ä¸€-lemonbench-ç®€å•ä»‹ç»">ä¸€ã€LemonBench ç®€å•ä»‹ç»</h1>
<p>LemonBenchç›®å‰æ¶µç›–äº†å¦‚ä¸‹æµ‹è¯•ï¼š</p>
<p>æœåŠ¡å™¨åŸºç¡€ä¿¡æ¯ (CPUä¿¡æ¯/å†…å­˜ä¿¡æ¯/Swapä¿¡æ¯/ç£ç›˜ç©ºé—´ä¿¡æ¯ç­‰)<br>
Speedtestç½‘é€Ÿæµ‹è¯• (æœ¬åœ°åˆ°æœ€è¿‘æºåŠå›½å†…å„åœ°åŸŸä¸åŒçº¿è·¯çš„ç½‘é€Ÿ)<br>
ç£ç›˜æµ‹è¯• (4Kå—/1Må— ç›´æ¥å†™å…¥æµ‹è¯•)<br>
è·¯ç”±è¿½è¸ªæµ‹è¯• (è¿½è¸ªåˆ°å›½å†…å’Œæµ·å¤–ä¸åŒçº¿è·¯çš„è·¯ç”±ä¿¡æ¯)<br>
Spooferæµ‹è¯• (è·å–è¯¦ç»†ç½‘ç»œä¿¡æ¯ï¼Œå¿«é€Ÿåˆ¤æ–­æœåŠ¡å™¨æ¥å…¥çº¿è·¯)<br>
LemonBenchä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼Œåªéœ€è¦å¤åˆ¶ç²˜è´´å†æ¥ä¸ªå›è½¦å°±å¯ä»¥è½»æ¾å¯åŠ¨æµ‹è¯•ã€‚</p>
<h1 id="äºŒ-lemonbench-ä½¿ç”¨æ–¹æ³•">äºŒã€LemonBench ä½¿ç”¨æ–¹æ³•</h1>
<h2 id="1-å¿«é€Ÿæµ‹è¯•">1ã€å¿«é€Ÿæµ‹è¯•</h2>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨ä¸Šå®‰è£…æœ‰ <code>curl</code> å·¥å…·ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œè„šæœ¬ï¼š</p>
<pre><code class="language-sh">curl -fsSL https://ilemonrain.com/download/shell/LemonBench.sh | bash -s fast
</code></pre>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨ä¸Šå®‰è£…æœ‰ <code>wget</code> å·¥å…·ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œè„šæœ¬ï¼š</p>
<pre><code class="language-sh">wget -qO- https://ilemonrain.com/download/shell/LemonBench.sh | bash -s fast
</code></pre>
<h2 id="2-å®Œæ•´æµ‹è¯•">2ã€å®Œæ•´æµ‹è¯•</h2>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨ä¸Šå®‰è£…æœ‰ <code>curl</code> å·¥å…·ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œè„šæœ¬ï¼š</p>
<pre><code class="language-shell">curl -fsSL https://ilemonrain.com/download/shell/LemonBench.sh | bash -s full
</code></pre>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨ä¸Šå®‰è£…æœ‰ <code>wget</code> å·¥å…·ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œè„šæœ¬ï¼š</p>
<pre><code class="language-shell">wget -qO- https://ilemonrain.com/download/shell/LemonBench.sh | bash -s full
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[linux-vim]]></title>
        <id>https://www.cyanzoy.top/post/XQroA40u4</id>
        <link href="https://www.cyanzoy.top/post/XQroA40u4">
        </link>
        <updated>2019-10-14T09:53:18.000Z</updated>
        <content type="html"><![CDATA[<h1 id="vimä¸­çš„æœç´¢">vimä¸­çš„æœç´¢</h1>
<p>æœç´¢æ–¹å¼ï¼š <code>/word</code><br>
ä¸‹ä¸€ä¸ªåŒ¹é… <code>n</code> ä¸Šä¸€ä¸ªåŒ¹é… <code>N</code><br>
ç¬¬ä¸€ä¸ªåŒ¹é…å¤„: <code>ggn</code><br>
æœ€åä¸€å¤„ <code>GN</code></p>
<h2 id="è‡ªå®šä¹‰æœç´¢">è‡ªå®šä¹‰æœç´¢</h2>
<ol>
<li>é€šè¿‡è®¾ç½® <code>hlsearch</code>æ¥é«˜äº®æœç´¢ç»“æœ<pre><code class="language-shell">:set hlsearch
</code></pre>
</li>
<li>ä½¿æœç´¢ä¸åŒºåˆ†å¤§å°å†™<pre><code class="language-shell"> :set ignorecase
</code></pre>
</li>
<li>æ™ºèƒ½å¤§å°å†™æœç´¢<pre><code class="language-shell"> :set ignorecase
 :set smartcase
</code></pre>
</li>
<li>é€’è¿›æœç´¢<pre><code class="language-shell"> :set incsearch
</code></pre>
</li>
<li>ç¦æ­¢ç¯å½¢æœç´¢<pre><code class="language-shell"> :set nowrapscan
</code></pre>
</li>
<li>å†æ¬¡å¼€å¯ç¯å½¢æœç´¢<pre><code class="language-shell"> :set wrapscan
</code></pre>
</li>
</ol>
<ul>
<li>å¦‚æœä½ æƒ³è¦æœç´¢ä¸€ä¸ªæ–‡ä»¶ä¸­çš„ä¸€ä¸ªå•è¯ï¼Œä½†æ˜¯åˆä¸æƒ³è¾“å…¥å®ƒï¼Œä½ åªéœ€è¦å°†ä½ çš„å…‰æ ‡ç§»åˆ°è¿™ä¸ªå•è¯ä¸‹ç„¶åæŒ‰ <code>*</code>(æˆ–è€… <code>shift + 8</code>)ã€‚å¦‚æœä½ æƒ³è¦å¯åŠ¨ä¸€æ¬¡éƒ¨åˆ†æœç´¢(ä¾‹å¦‚:åŒæ—¶æœç´¢ <strong>in</strong> å’Œ <strong>terminal</strong>)ï¼Œé‚£ä½ éœ€è¦å°†å…‰æ ‡ç§»åˆ°åˆ°å•è¯ä¸‹ï¼Œç„¶åé€šè¿‡åœ¨é”®ç›˜ä¸ŠæŒ‰ <code>g*</code> (æŒ‰ä¸€æ¬¡ <code>g</code> ç„¶åä¸æ–­æŒ‰ <code>*</code> )ã€‚<br>
<strong>å¦å¤–</strong>:å¦‚æœä½ æƒ³è¦é€†å‘æœç´¢ï¼ŒæŒ‰ <code>#</code> æˆ–è€… <code>g#</code> ã€‚</li>
<li>æœ€åï¼Œå‡è®¾ä½ æƒ³è¦å¯¹æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨çš„å•è¯åšä¸€ç‚¹å°å°çš„ä¿®æ”¹ï¼Œç„¶åå¯¹ä¿®æ”¹åçš„å•è¯æ‰§è¡Œæœç´¢æ“ä½œ,ä¸€ç§æ–¹æ³•æ˜¯è¾“å…¥ <code>/</code> ä¸è¦æœç´¢çš„å•è¯ã€‚ä½†æ˜¯å¦‚æœè¿™ä¸ªå•è¯åˆé•¿åˆå¤æ‚ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´æ¥è¾“å…¥å®ƒã€‚<br>
ä¸€ä¸ªæ–¹æ³•æ˜¯å°†å…‰æ ‡ç§»åˆ°ä½ æƒ³è¦ç•¥å¾®ä¿®æ”¹çš„å•è¯ä¸‹ï¼ŒæŒ‰ <code>/</code> ä¹‹åå†æŒ‰ <code>Ctrl + r</code> æœ€åæŒ‰ <code>Ctrl + w</code>ã€‚è¿™ä¸ªåœ¨å…‰æ ‡ä¸‹çš„å•è¯ä¸ä»…ä»…ä¼šè¢«æ‹·è´ï¼Œä¹Ÿä¼šè¢«å¤åˆ¶åˆ° <code>/</code> åï¼Œå…è®¸ä½ å¯¹å®ƒè¿›è¡Œä¿®æ”¹å¹¶ä¸”ç»§ç»­è¿›è¡Œæœç´¢æ“ä½œã€‚</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[uwsgiå¯åŠ¨djangoæœåŠ¡]]></title>
        <id>https://www.cyanzoy.top/post/_7T3uDhTS</id>
        <link href="https://www.cyanzoy.top/post/_7T3uDhTS">
        </link>
        <updated>2019-10-08T07:25:14.000Z</updated>
        <summary type="html"><![CDATA[<p>è„šæœ¬åˆ—è¡¨<br>
å¯åŠ¨djangoæœåŠ¡ç”¨çš„Uwsgiçš„iniå¯åŠ¨é…ç½®æ–‡ä»¶,å¯åŠ¨è„šæœ¬,è‡ªå®šä¹‰serviceè„šæœ¬</p>
]]></summary>
        <content type="html"><![CDATA[<p>è„šæœ¬åˆ—è¡¨<br>
å¯åŠ¨djangoæœåŠ¡ç”¨çš„Uwsgiçš„iniå¯åŠ¨é…ç½®æ–‡ä»¶,å¯åŠ¨è„šæœ¬,è‡ªå®šä¹‰serviceè„šæœ¬</p>
<!-- more -->
<h1 id="uwsgiini">uwsgi.ini</h1>
<pre><code class="language-ini"># uwsgi é…ç½®æ–‡ä»¶
[uwsgi]
#ç«¯å£
socket = 127.0.0.1:8000
# djangoé¡¹ç›®ç»å¯¹è·¯å¾„
chdir = /home/centos/project/diary
# æ¨¡å—è·¯å¾„ï¼ˆé¡¹ç›®åç§°.wsgiï¼‰å¯ä»¥ç†è§£ä¸ºwsgi.pyçš„ä½ç½®
module = diary.wsgi
# å…è®¸ä¸»è¿›ç¨‹
master = true
#æœ€å¤šè¿›ç¨‹æ•°
processes  = 4
# é€€å‡ºæ—¶å€™å›æ”¶pidæ–‡ä»¶
vacuum = true
#æ—¥å¿—å¤§å°é…ç½®500M
log-maxsize = 500000000 
#è®°å½•æ—¥å¿—é…ç½®
logto = /home/centos/project/logs/uwsgi8000.log
pidfile = /home/centos/project/logs/uwsgi8000.pid

#[uwsgi]
#socket = :8000
#master = true
#vhost = true
#gid = nginx
#uid = nginx
#no-stie = true
#enable-threads = true
#workers = 2
#reload-mercy = 10
#vacuum = true
#max-requests = 1000
#limit-as = 512
#buffer-sizi = 30000
#pidfile = /var/run/uwsgi8000diary.pid
#daemonize = /home/centos/project/logs/diary/uwsgi.log
#wsgi-file = /home/centos/project/diary/diary/wsgi.py
#chdir = /home/centos/project/diary
#module=diary.wsgi:application
#virtualenv = /usr/local/python3.7
#vacuum = True
</code></pre>
<h1 id="å¯åŠ¨è„šæœ¬-etcinitd">å¯åŠ¨è„šæœ¬ /etc/init.d/</h1>
<pre><code class="language-bash">#! /bin/sh
# chkconfig: 2345 55 25
# Description: Startup script for uwsgi webserver on Debian. Place in /etc/init.d and
# run 'update-rc.d -f uwsgi defaults', or use the appropriate command on your
# distro. For CentOS/Redhat run: 'chkconfig --add uwsgi'

### BEGIN INIT INFO
# Provides:          uwsgi
# Required-Start:    $all
# Required-Stop:     $all
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: starts the uwsgi web server
# Description:       starts uwsgi using start-stop-daemon
### END INIT INFO

# Author:   licess
# website:  http://lnmp.org

PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/python3.7/bin
DESC=&quot;uwsgi daemon&quot;
NAME=uwsgi8000diary
DAEMON=/usr/bin/uwsgi
CONFIGFILE=/home/centos/project/confini/$NAME.ini
PIDFILE=/var/run/$NAME.pid
SCRIPTNAME=/etc/init.d/$NAME

set -e
[ -x &quot;$DAEMON&quot; ] || exit 0

do_start() {
    $DAEMON --ini $CONFIGFILE || echo -n &quot;uwsgi already running&quot;
}

do_stop() {
    $DAEMON --stop $PIDFILE || echo -n &quot;uwsgi not running&quot;
    rm -f $PIDFILE
    echo &quot;$DAEMON STOPED.&quot;
}

do_reload() {
    $DAEMON --reload $PIDFILE || echo -n &quot;uwsgi can't reload&quot;
}

do_status() {
    ps aux|grep $DAEMON
}

case &quot;$1&quot; in
 status)
    echo -en &quot;Status $NAME: \n&quot;
    do_status
 ;;
 start)
    echo -en &quot;Starting $NAME: \n&quot;
    do_start
 ;;
 stop)
    echo -en &quot;Stopping $NAME: \n&quot;
    do_stop
 ;;
 reload|graceful)
    echo -en &quot;Reloading $NAME: \n&quot;
    do_reload
 ;;
 *)
    echo &quot;Usage: $SCRIPTNAME {start|stop|reload}&quot; &gt;&amp;2
    exit 3
 ;;
esac

exit 0

</code></pre>
<h1 id="service-è„šæœ¬-usrlibsystemdsystem">service è„šæœ¬ /usr/lib/systemd/system/</h1>
<pre><code class="language-ini">[Unit]
Documentation=man:systemd-sysv-generator(8)
SourcePath=/etc/rc.d/init.d/uwsgi9500_meetbuy
Description=LSB: starts the uwsgi web server
Before=runlevel2.target
Before=runlevel3.target
Before=runlevel4.target
Before=runlevel5.target
Before=shutdown.target
Before=agentwatch.service
After=all.target
After=network-online.target
Conflicts=shutdown.target

[Service]
Type=forking
Restart=no
TimeoutSec=5min
IgnoreSIGPIPE=no
KillMode=process
GuessMainPID=no
RemainAfterExit=yes
ExecStart=/etc/rc.d/init.d/uwsgi9500_meetbuy start
ExecStop=/etc/rc.d/init.d/uwsgi9500_meetbuy stop
ExecReload=/etc/rc.d/init.d/uwsgi9500_meetbuy reloa
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Nginxå®‰è£…]]></title>
        <id>https://www.cyanzoy.top/post/NzkqO5w9Y</id>
        <link href="https://www.cyanzoy.top/post/NzkqO5w9Y">
        </link>
        <updated>2019-09-27T09:02:15.000Z</updated>
        <summary type="html"><![CDATA[<p>ç®€ä»‹è®°å½•nginxçš„å®‰è£…</p>
]]></summary>
        <content type="html"><![CDATA[<p>ç®€ä»‹è®°å½•nginxçš„å®‰è£…</p>
<!-- more -->
<h1 id="éœ€è¦çš„ä¾èµ–ç¯å¢ƒ">éœ€è¦çš„ä¾èµ–ç¯å¢ƒ</h1>
<pre><code>yum -y install pcre pcre-devel
yum install openssl openssl-devel
</code></pre>
<h1 id="ç¼–è¯‘-å®‰è£…">ç¼–è¯‘ &amp;&amp; å®‰è£…</h1>
<pre><code>./configure --prefix=/usr/local/nginx --with-http_ssl_module
make &amp;&amp; make install
</code></pre>
<h1 id="å¯åŠ¨">å¯åŠ¨</h1>
<pre><code class="language-sh">nginx
</code></pre>
<h1 id="é‡å¯">é‡å¯</h1>
<pre><code class="language-sh">nginx -s reload
</code></pre>
<h1 id="æŒ‡å®šé…ç½®æ–‡ä»¶çš„å¯åŠ¨">æŒ‡å®šé…ç½®æ–‡ä»¶çš„å¯åŠ¨</h1>
<pre><code class="language-sh">nginx -c /usr/local/nginx/conf/nginx.conf
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ•°æ®åº“]]></title>
        <id>https://www.cyanzoy.top/post/LfyAN6ymf</id>
        <link href="https://www.cyanzoy.top/post/LfyAN6ymf">
        </link>
        <updated>2019-09-23T07:59:06.000Z</updated>
        <summary type="html"><![CDATA[<p>ä¸€ç³»åˆ—å‘½ä»¤</p>
]]></summary>
        <content type="html"><![CDATA[<p>ä¸€ç³»åˆ—å‘½ä»¤</p>
<!-- more -->
<h1 id="åˆ›å»ºç”¨æˆ·æˆæƒè®¾æ›´æ”¹åŠ å¯†æ¨¡å¼">åˆ›å»ºç”¨æˆ·ï¼Œæˆæƒï¼Œè®¾æ›´æ”¹åŠ å¯†æ¨¡å¼</h1>
<h2 id="åˆ›å»ºè´¦å·">åˆ›å»ºè´¦å·</h2>
<pre><code>CREATE USER 'username'@'host' IDENTIFIED BY 'password';
</code></pre>
<h2 id="æˆæƒ">æˆæƒ</h2>
<pre><code>GRANT privileges ON databasename.tablename TO 'username'@'host'
GRANT ALL ON databasename.* TO 'username'@'host'
è¯´æ˜:
# privilegesï¼šç”¨æˆ·çš„æ“ä½œæƒé™ï¼Œå¦‚SELECTï¼ŒINSERTï¼ŒUPDATEç­‰ï¼Œå¦‚æœè¦æˆäºˆæ‰€çš„æƒé™åˆ™ä½¿ç”¨ALL 
# databasenameï¼šæ•°æ®åº“å
# tablenameï¼šè¡¨åï¼Œå¦‚æœè¦æˆäºˆè¯¥ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™åˆ™å¯ç”¨è¡¨ç¤ºï¼Œå¦‚.*
</code></pre>
<pre><code>æ³¨æ„:
ç”¨ä»¥ä¸Šå‘½ä»¤æˆæƒçš„ç”¨æˆ·ä¸èƒ½ç»™å…¶å®ƒç”¨æˆ·æˆæƒï¼Œå¦‚æœæƒ³è®©è¯¥ç”¨æˆ·å¯ä»¥æˆæƒï¼Œç”¨ä»¥ä¸‹å‘½ä»¤:
GRANT privileges ON databasename.tablename TO 'username'@'host' WITH GRANT OPTION;
</code></pre>
<h2 id="è®¾ç½®ä¸æ›´æ”¹ç”¨æˆ·å¯†ç ">è®¾ç½®ä¸æ›´æ”¹ç”¨æˆ·å¯†ç </h2>
<pre><code>å‘½ä»¤:
SET PASSWORD FOR 'username'@'host' = PASSWORD('newpassword');
å¦‚æœæ˜¯å½“å‰ç™»é™†ç”¨æˆ·ç”¨:
SET PASSWORD = PASSWORD(&quot;newpassword&quot;);
ä¾‹å­:
SET PASSWORD FOR 'pig'@'%' = PASSWORD(&quot;123456&quot;);
</code></pre>
<h2 id="æ’¤é”€ç”¨æˆ·æƒé™">æ’¤é”€ç”¨æˆ·æƒé™</h2>
<pre><code>REVOKE privilege ON databasename.tablename FROM 'username'@'host';
è¯´æ˜:
privilege, databasename, tablenameï¼šåŒæˆæƒéƒ¨åˆ†
ä¾‹å­:
REVOKE SELECT ON *.* FROM 'pig'@'%';
å‡å¦‚ä½ åœ¨ç»™ç”¨æˆ· 'pig'@ '%'æˆæƒçš„æ—¶å€™æ˜¯è¿™æ ·çš„ï¼ˆæˆ–ç±»ä¼¼çš„ï¼‰ï¼šGRANT SELECT ON test.user TO 'pig'@'%'ï¼Œåˆ™åœ¨ä½¿ç”¨REVOKE SELECT ON . FROM 'pig'@'%';å‘½ä»¤å¹¶ä¸èƒ½æ’¤é”€è¯¥ç”¨æˆ·å¯¹testæ•°æ®åº“ä¸­userè¡¨çš„SELECT æ“ä½œã€‚
åŒç†ï¼Œå¦‚æœæˆæƒä½¿ç”¨çš„æ˜¯GRANT SELECT ON . TO 'pig'@'%';åˆ™REVOKE SELECT ON test.user FROM 'pig'@'%';å‘½ä»¤ä¹Ÿä¸èƒ½æ’¤é”€è¯¥ç”¨æˆ·å¯¹testæ•°æ®åº“ä¸­userè¡¨çš„Selectæƒé™ã€‚
å…·ä½“ä¿¡æ¯å¯ä»¥ç”¨å‘½ä»¤SHOW GRANTS FOR 'pig'@'%'; æŸ¥çœ‹ã€‚
</code></pre>
<h2 id="åˆ é™¤ç”¨æˆ·">åˆ é™¤ç”¨æˆ·</h2>
<pre><code>DROP USER 'username'@'host';
</code></pre>
<h2 id="mysql8-åŠ å¯†æ–¹å¼ä¸åŒå¦‚æœ‰éœ€è¦å¯è¿è¡Œä¸‹é¢è¿™å¥è¿›è¡Œæ›´æ”¹">mysql8 åŠ å¯†æ–¹å¼ä¸åŒï¼Œå¦‚æœ‰éœ€è¦å¯è¿è¡Œä¸‹é¢è¿™å¥è¿›è¡Œæ›´æ”¹</h2>
<pre><code>ALTER USER 'tone'@'%' IDENTIFIED WITH mysql_native_password BY '123456';
FLUSH PRIVILEGES; 
</code></pre>
<h1 id="æ•°æ®è·¯åŠ è§£å¯†sql">æ•°æ®è·¯åŠ è§£å¯†sql</h1>
<pre><code class="language-sql">fjarg3z30xtjcewyonjkkh6g7qub4tdei0dhu4bog å¯†é’¥
è§£å¯†
SELECT AES_DECRYPT(UNHEX('å·²åŠ å¯†å†…å®¹'), 'fjarg3z30xtjcewyonjkkh6g7qub4tdei0dhu4bog')
åŠ å¯†
SELECT  HEX(AES_ENCRYPT('å¾…åŠ å¯†å†…å®¹', 'fjarg3z30xtjcewyonjkkh6g7qub4tdei0dhu4bog'))
</code></pre>
<h2 id="å…¶ä»–">å…¶ä»–</h2>
<p>1.æ•°æ®åº“ç›®å½•<br>
/var/lib/mysql/<br>
2.é…ç½®æ–‡ä»¶<br>
/usr/share/mysqlï¼ˆmysql.serverå‘½ä»¤åŠé…ç½®æ–‡ä»¶ï¼‰mysql5.5ä¹‹åçš„é»˜è®¤å®‰è£…è·¯å¾„ï¼Œmysql5.5ä¹‹å‰çš„æ˜¯/usr/local/mysql<br>
3.ç›¸å…³å‘½ä»¤<br>
/usr/bin(mysqladmin mysqldumpç­‰å‘½ä»¤)<br>
4.å¯åŠ¨è„šæœ¬<br>
/etc/rc.d/init.d/ï¼ˆå¯åŠ¨è„šæœ¬æ–‡ä»¶mysqlçš„ç›®å½•ï¼‰</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åç«¯å¿…å¤‡ Nginx é…ç½®]]></title>
        <id>https://www.cyanzoy.top/post/9XwZQILat</id>
        <link href="https://www.cyanzoy.top/post/9XwZQILat">
        </link>
        <updated>2019-09-19T02:55:54.000Z</updated>
        <summary type="html"><![CDATA[<ul>
<li>é˜²ç›—é“¾</li>
<li>æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®è¿‡æœŸæ—¶é—´</li>
<li>é™æ€èµ„æºè®¿é—®<br>
Â·Â·Â·</li>
</ul>
]]></summary>
        <content type="html"><![CDATA[<ul>
<li>é˜²ç›—é“¾</li>
<li>æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®è¿‡æœŸæ—¶é—´</li>
<li>é™æ€èµ„æºè®¿é—®<br>
Â·Â·Â·</li>
</ul>
<!-- more -->
<ul>
<li>æ—¥å¿—é…ç½®</li>
<li>æ—¥å¿—å­—æ®µè¯´æ˜</li>
<li>access_log è®¿é—®æ—¥å¿—</li>
<li>error_log æ—¥å¿—</li>
<li>æ—¥å¿—åˆ‡å‰²</li>
<li>åå‘ä»£ç†</li>
<li>ç¦æ­¢æŒ‡å®šuser_agent</li>
<li>nginxè®¿é—®æ§åˆ¶</li>
<li>è´Ÿè½½å‡è¡¡</li>
<li>Nginxçš„rewrite</li>
</ul>
<h2 id="é˜²ç›—é“¾">é˜²ç›—é“¾</h2>
<pre><code>location ~* \.(gif|jpg|png)$ {
    # åªå…è®¸ 192.168.0.1 è¯·æ±‚èµ„æº
    valid_referers none blocked 192.168.0.1;
    if ($invalid_referer) {
       rewrite ^/ http://$host/logo.png;
    }
}
</code></pre>
<h2 id="æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®è¿‡æœŸæ—¶é—´">æ ¹æ®æ–‡ä»¶ç±»å‹è®¾ç½®è¿‡æœŸæ—¶é—´</h2>
<pre><code>location ~.*\.css$ {
    expires 1d;
    break;
}
location ~.*\.js$ {
    expires 1d;
    break;
}
location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
    access_log off;
    expires 15d;    #ä¿å­˜15å¤©
    break;
}

# curl -x127.0.0.1:80 http://www.test.com/static/image/common/logo.png -I #
æµ‹è¯•å›¾ç‰‡çš„max-age
</code></pre>
<h2 id="é™æ€èµ„æºè®¿é—®">é™æ€èµ„æºè®¿é—®</h2>
<pre><code>http {
    # è¿™ä¸ªå°†ä¸ºæ‰“å¼€æ–‡ä»¶æŒ‡å®šç¼“å­˜ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯ç”¨çš„ï¼Œmax æŒ‡å®šç¼“å­˜æ•°é‡ï¼Œ
    # å»ºè®®å’Œæ‰“å¼€æ–‡ä»¶æ•°ä¸€è‡´ï¼Œinactive æ˜¯æŒ‡ç»è¿‡å¤šé•¿æ—¶é—´æ–‡ä»¶æ²¡è¢«è¯·æ±‚ååˆ é™¤ç¼“å­˜ã€‚
    open_file_cache max=204800 inactive=20s;

    # open_file_cache æŒ‡ä»¤ä¸­çš„inactive å‚æ•°æ—¶é—´å†…æ–‡ä»¶çš„æœ€å°‘ä½¿ç”¨æ¬¡æ•°ï¼Œ
    # å¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸€ç›´æ˜¯åœ¨ç¼“å­˜ä¸­æ‰“å¼€çš„ï¼Œå¦‚ä¸Šä¾‹ï¼Œå¦‚æœæœ‰ä¸€ä¸ª
    # æ–‡ä»¶åœ¨inactive æ—¶é—´å†…ä¸€æ¬¡æ²¡è¢«ä½¿ç”¨ï¼Œå®ƒå°†è¢«ç§»é™¤ã€‚
    open_file_cache_min_uses 1;

    # è¿™ä¸ªæ˜¯æŒ‡å¤šé•¿æ—¶é—´æ£€æŸ¥ä¸€æ¬¡ç¼“å­˜çš„æœ‰æ•ˆä¿¡æ¯
    open_file_cache_valid 30s;

    # é»˜è®¤æƒ…å†µä¸‹ï¼ŒNginxçš„gzipå‹ç¼©æ˜¯å…³é—­çš„ï¼Œ gzipå‹ç¼©åŠŸèƒ½å°±æ˜¯å¯ä»¥è®©ä½ èŠ‚çœä¸
    # å°‘å¸¦å®½ï¼Œä½†æ˜¯ä¼šå¢åŠ æœåŠ¡å™¨CPUçš„å¼€é”€å“¦ï¼ŒNginxé»˜è®¤åªå¯¹text/htmlè¿›è¡Œå‹ç¼© ï¼Œ
    # å¦‚æœè¦å¯¹htmlä¹‹å¤–çš„å†…å®¹è¿›è¡Œå‹ç¼©ä¼ è¾“ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ¥è®¾ç½®ã€‚
    gzip on;
    gzip_min_length 1k;
    gzip_buffers 4 16k;
    gzip_http_version 1.0;
    gzip_comp_level 2;
    gzip_types text/plain application/x-javascript text/css application/xml;


    server {
        listen       80;
        server_name www.test.com;
        charset utf-8;
        root   /data/www.test.com;
        index  index.html index.htm;
    }
}
</code></pre>
<h2 id="æ—¥å¿—é…ç½®">æ—¥å¿—é…ç½®</h2>
<h3 id="æ—¥å¿—å­—æ®µè¯´æ˜">æ—¥å¿—å­—æ®µè¯´æ˜</h3>
<table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>remote_addr å’Œ http_x_forwarded_for</td>
<td>å®¢æˆ·ç«¯ IP åœ°å€</td>
</tr>
<tr>
<td>remote_user</td>
<td>å®¢æˆ·ç«¯ç”¨æˆ·åç§°</td>
</tr>
<tr>
<td>request</td>
<td>è¯·æ±‚çš„ URI å’Œ HTTP åè®®</td>
</tr>
<tr>
<td>status</td>
<td>è¯·æ±‚çŠ¶æ€</td>
</tr>
<tr>
<td>body_bytes_sent</td>
<td>è¿”å›ç»™å®¢æˆ·ç«¯çš„å­—èŠ‚æ•°ï¼Œä¸åŒ…æ‹¬å“åº”å¤´çš„å¤§å°</td>
</tr>
<tr>
<td>bytes_sent</td>
<td>è¿”å›ç»™å®¢æˆ·ç«¯æ€»å­—èŠ‚æ•°</td>
</tr>
<tr>
<td>connection</td>
<td>è¿æ¥çš„åºåˆ—å·</td>
</tr>
<tr>
<td>connection_requests</td>
<td>å½“å‰åŒä¸€ä¸ª TCP è¿æ¥çš„çš„è¯·æ±‚æ•°é‡</td>
</tr>
<tr>
<td>msec</td>
<td>æ—¥å¿—å†™å…¥æ—¶é—´ã€‚å•ä½ä¸ºç§’ï¼Œç²¾åº¦æ˜¯æ¯«ç§’</td>
</tr>
<tr>
<td>pipe</td>
<td>å¦‚æœè¯·æ±‚æ˜¯é€šè¿‡HTTPæµæ°´çº¿(pipelined)å‘é€ï¼Œpipeå€¼ä¸º&quot;p&quot;ï¼Œå¦åˆ™ä¸º&quot;.&quot;</td>
</tr>
<tr>
<td>http_referer</td>
<td>è®°å½•ä»å“ªä¸ªé¡µé¢é“¾æ¥è®¿é—®è¿‡æ¥çš„</td>
</tr>
<tr>
<td>http_user_agent</td>
<td>è®°å½•å®¢æˆ·ç«¯æµè§ˆå™¨ç›¸å…³ä¿¡æ¯</td>
</tr>
<tr>
<td>request_length</td>
<td>è¯·æ±‚çš„é•¿åº¦(åŒ…æ‹¬è¯·æ±‚è¡Œï¼Œè¯·æ±‚å¤´å’Œè¯·æ±‚æ­£æ–‡)</td>
</tr>
<tr>
<td>time_iso8601</td>
<td>ISO8601æ ‡å‡†æ ¼å¼ä¸‹çš„æœ¬åœ°æ—¶é—´</td>
</tr>
<tr>
<td>time_local</td>
<td>è®°å½•è®¿é—®æ—¶é—´ä¸æ—¶åŒº</td>
</tr>
</tbody>
</table>
<h2 id="access_log-è®¿é—®æ—¥å¿—">access_log è®¿é—®æ—¥å¿—</h2>
<pre><code>http {
    log_format  access  '$remote_addr - $remote_user [$time_local] $host &quot;$request&quot; '
                  '$status $body_bytes_sent &quot;$http_referer&quot; '
                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot; &quot;$clientip&quot;';
    access_log  /srv/log/nginx/talk-fun.access.log  access;
}
</code></pre>
<h2 id="error_log-æ—¥å¿—">error_log æ—¥å¿—</h2>
<pre><code>error_log  /srv/log/nginx/nginx_error.log  error;
# error_log /dev/null; # çœŸæ­£çš„å…³é—­é”™è¯¯æ—¥å¿—
http {
    # ...
}
</code></pre>
<h2 id="æ—¥å¿—åˆ‡å‰²">æ—¥å¿—åˆ‡å‰²</h2>
<pre><code># å’Œapacheä¸åŒçš„æ˜¯ï¼Œnginxæ²¡æœ‰apacheä¸€æ ·çš„å·¥å…·åšåˆ‡å‰²ï¼Œéœ€è¦ç¼–å†™è„šæœ¬å®ç°ã€‚# åœ¨/usr/local/sbinä¸‹å†™è„šæœ¬

#!/bin/bash
dd=$(date -d '-1 day' +%F)[ -d /tmp/nginx_log ] || mkdir /tmp/nginx_log
mv /tmp/nginx_access.log /tmp/nginx_log/$dd.log
/etc/init.d/nginx reload &gt; /dev/null
</code></pre>
<h2 id="åå‘ä»£ç†">åå‘ä»£ç†</h2>
<pre><code>http {
    include mime.types;
    server_tokens off;

    ## é…ç½®åå‘ä»£ç†çš„å‚æ•°
    server {
        listen    8080;

        ## 1. ç”¨æˆ·è®¿é—® http://ip:portï¼Œåˆ™åå‘ä»£ç†åˆ° https://github.com
        location / {
            proxy_pass  https://github.com;
            proxy_redirect     off;
            proxy_set_header   Host             $host;
            proxy_set_header   X-Real-IP        $remote_addr;
            proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        }

        ## 2.ç”¨æˆ·è®¿é—® http://ip:port/README.mdï¼Œåˆ™åå‘ä»£ç†åˆ°
        ##   https://github.com/zibinli/blog/blob/master/README.md
        location /README.md {
            proxy_set_header  X-Real-IP  $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_pass https://github.com/zibinli/blog/blob/master/README.md;
        }
    }
}
</code></pre>
<h2 id="ç¦æ­¢æŒ‡å®šuser_agent">ç¦æ­¢æŒ‡å®šuser_agent</h2>
<pre><code>#è™šæ‹Ÿä¸»æœºçš„é…ç½®æ–‡ä»¶é‡ŒåŠ å…¥ï¼š
if ($http_user_agent ~* 'baidu|360|sohu') #ç¦æ­¢useragentä¸ºbaiduã€360å’Œsohuï¼Œ~*è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™åŒ¹é…
{
   return 403;
}

location /  å’Œ  location  ~ /  ä¼˜å…ˆçº§æ˜¯ä¸ä¸€æ ·çš„ã€‚ 
ç»“åˆè¿™ä¸ªæ–‡ç« ç ”ç©¶ä¸€ä¸‹å§ http://blog.itpub.net/27181165/viewspace-777202/
curl -A &quot;baidu&quot; -x127.0.0.1:80 www.test.com/forum.php -I    è¯¥å‘½ä»¤æŒ‡å®šç™¾åº¦ä¸ºuser_agent,è¿”å›403
</code></pre>
<h2 id="nginxè®¿é—®æ§åˆ¶">nginxè®¿é—®æ§åˆ¶</h2>
<pre><code># å¯ä»¥è®¾ç½®ä¸€äº›é…ç½®ç¦æ­¢ä¸€äº›ipçš„è®¿é—®

deny 127.0.0.1;     #å…¨å±€å®šä¹‰é™åˆ¶ï¼Œlocationé‡Œçš„æ˜¯å±€éƒ¨å®šä¹‰çš„ã€‚å¦‚æœä¸¤è€…å†²çªï¼Œä»¥locationè¿™ç§ç²¾ç¡®åœ°ä¼˜å…ˆï¼Œ

location ~ .*admin\.php$ {
    #auth_basic &quot;cct auth&quot;;
    #auth_basic_user_file /usr/local/nginx/conf/.htpasswd;

    allow 127.0.0.1;  åªå…è®¸127.0.0.1çš„è®¿é—®ï¼Œå…¶ä»–å‡æ‹’ç»
    deny all;

    include fastcgi_params;
    fastcgi_pass unix:/tmp/www.sock;
    fastcgi_index index.php;
    fastcgi_param SCRIPT_FILENAME /data/www$fastcgi_script_name;
}
</code></pre>
<h2 id="è´Ÿè½½å‡è¡¡">è´Ÿè½½å‡è¡¡</h2>
<pre><code>http {
    upstream test.net {
        ip_hash;
        server 192.168.10.13:80;
        server 192.168.10.14:80  down;
        server 192.168.10.15:8009  max_fails=3  fail_timeout=20s;
        server 192.168.10.16:8080;
    }
    server {
        location / {
            proxy_pass  http://test.net;
        }
    }
}
</code></pre>
<h1 id="nginxçš„rewrite">Nginxçš„rewrite</h1>
<h2 id="rewite">rewite</h2>
<p>åœ¨<code>server</code>å—ä¸‹ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œ<code>rewrite</code>éƒ¨åˆ†ï¼Œç„¶åæ‰ä¼šå»åŒ¹é…<code>location</code>å—<br>
<code>server</code>ä¸­çš„<code>rewrite break</code>å’Œ<code>last</code>æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œéƒ½ä¼šå»åŒ¹é…<code>location</code>ï¼Œæ‰€ä»¥æ²¡å¿…è¦ç”¨<code>last</code>å†å‘èµ·æ–°çš„è¯·æ±‚ï¼Œå¯ä»¥ç•™ç©º</p>
<h2 id="locationä¸­çš„rewirte">locationä¸­çš„rewirteï¼š</h2>
<p>ä¸å†™lastå’Œbreak - é‚£ä¹ˆæµç¨‹å°±æ˜¯ä¾æ¬¡æ‰§è¡Œè¿™äº›rewrite</p>
<ol>
<li><code>rewrite break</code> - urlé‡å†™åï¼Œç›´æ¥ä½¿ç”¨å½“å‰èµ„æºï¼Œä¸å†æ‰§è¡Œlocationé‡Œä½™ä¸‹çš„è¯­å¥ï¼Œå®Œæˆæœ¬æ¬¡è¯·æ±‚ï¼Œåœ°å€æ urlä¸å˜</li>
<li><code>rewrite last</code> - urlé‡å†™åï¼Œé©¬ä¸Šå‘èµ·ä¸€ä¸ªæ–°çš„è¯·æ±‚ï¼Œå†æ¬¡è¿›å…¥serverå—ï¼Œé‡è¯•locationåŒ¹é…ï¼Œè¶…è¿‡10æ¬¡åŒ¹é…ä¸åˆ°æŠ¥500é”™è¯¯ï¼Œåœ°å€æ urlä¸å˜</li>
<li><code>rewrite redirect</code> â€“ è¿”å›302ä¸´æ—¶é‡å®šå‘ï¼Œåœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„urlï¼Œçˆ¬è™«ä¸ä¼šæ›´æ–°urlï¼ˆå› ä¸ºæ˜¯ä¸´æ—¶ï¼‰</li>
<li><code>rewrite permanent</code> â€“ è¿”å›301æ°¸ä¹…é‡å®šå‘, åœ°å€æ æ˜¾ç¤ºé‡å®šå‘åçš„urlï¼Œçˆ¬è™«æ›´æ–°url</li>
</ol>
<h2 id="ä½¿ç”¨lastä¼šå¯¹serveræ ‡ç­¾é‡æ–°å‘èµ·è¯·æ±‚">ä½¿ç”¨lastä¼šå¯¹serveræ ‡ç­¾é‡æ–°å‘èµ·è¯·æ±‚</h2>
<ul>
<li>å¦‚æœlocationä¸­rewriteåæ˜¯å¯¹é™æ€èµ„æºçš„è¯·æ±‚ï¼Œä¸éœ€è¦å†è¿›è¡Œå…¶ä»–åŒ¹é…ï¼Œä¸€èˆ¬è¦ä½¿ç”¨breakæˆ–ä¸å†™ï¼Œç›´æ¥ä½¿ç”¨å½“å‰locationä¸­çš„æ•°æ®æºï¼Œå®Œæˆæœ¬æ¬¡è¯·æ±‚</li>
<li>å¦‚æœlocationä¸­rewriteåï¼Œè¿˜éœ€è¦è¿›è¡Œå…¶ä»–å¤„ç†ï¼Œå¦‚åŠ¨æ€fastcgiè¯·æ±‚(.php,.jsp)ç­‰ï¼Œè¦ç”¨lastç»§ç»­å‘èµ·æ–°çš„è¯·æ±‚</li>
<li>(æ ¹çš„locationä½¿ç”¨lastæ¯”è¾ƒå¥½, å› ä¸ºå¦‚æœæœ‰.phpç­‰fastcgiè¯·æ±‚è¿˜è¦ç»§ç»­å¤„ç†)</li>
<li>ä½¿ç”¨aliasæŒ‡å®šæºï¼šå¿…é¡»ä½¿ç”¨last</li>
<li>ifè¯­å¥ä¸»è¦ç”¨æ¥åˆ¤æ–­ä¸€äº›åœ¨rewriteè¯­å¥ä¸­æ— æ³•ç›´æ¥åŒ¹é…çš„æ¡ä»¶,æ¯”å¦‚æ£€æµ‹æ–‡ä»¶å­˜åœ¨ä¸å¦,http header,cookieç­‰</li>
</ul>
<h2 id="locationåŒ¹é…è§„åˆ™åŠä¼˜å…ˆçº§">locationåŒ¹é…è§„åˆ™åŠä¼˜å…ˆçº§</h2>
<table>
<thead>
<tr>
<th>åŒ¹é…è§„åˆ™</th>
<th>ä¼˜å…ˆçº§</th>
</tr>
</thead>
<tbody>
<tr>
<td>=</td>
<td>ä¸¥æ ¼åŒ¹é…è¿™ä¸ªæŸ¥è¯¢ã€‚å¦‚æœæ‰¾åˆ°ï¼Œåœæ­¢æœç´¢ã€‚</td>
</tr>
<tr>
<td>^~</td>
<td>åŒ¹é…è·¯å¾„çš„å‰ç¼€ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåœæ­¢æœç´¢ã€‚</td>
</tr>
<tr>
<td>~</td>
<td>ä¸ºåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…</td>
</tr>
<tr>
<td>~*</td>
<td>ä¸ºä¸åŒºåˆ†å¤§å°å†™åŒ¹é…</td>
</tr>
<tr>
<td>ä¼˜å…ˆçº§ï¼š</td>
<td>=, ^~, <sub>/</sub>*, æ— </td>
</tr>
</tbody>
</table>
<h2 id="breakè¯­å¥">breakè¯­å¥</h2>
<p>æ”¾åœ¨<code>server</code>å—<code>rewrite</code>è¯­å¥å‰é¢<br>
å¦‚æœæ˜¯ç›´æ¥è¯·æ±‚æŸä¸ªçœŸå®å­˜åœ¨çš„æ–‡ä»¶,åˆ™ç”¨breakè¯­å¥åœæ­¢rewriteæ£€æŸ¥</p>
<pre><code>if (-f $request_filename) { 
    break; 
}
</code></pre>
<h1 id="è®°å½•">è®°å½•</h1>
<pre><code class="language-nginx">http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
    #                  '$status $body_bytes_sent &quot;$http_referer&quot; '
    #                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

    server {
        listen       80;
        server_name  www.cyanzoy.top;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   /mnt/project/blog/MAOA-L.github.io/;
	        rewrite ^/(.*) https://www.cyanzoy.top/$1 last;
            # index  index.html index.htm;
        }        
	    location /styles {
            alias   /mnt/project/blog/MAOA-L.github.io/styles/;
        }
        # å¦‚æœæ˜¯åšä»£ç†(django-uwsgiæœåŠ¡)
        location / {
            #root   /usr/share/nginx/aichensmart;
            #index  index.php index.html index.htm;
            include /etc/nginx/uwsgi_params;
            uwsgi_pass 127.0.0.1:port;
        }

	
        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }

    server {
        listen 	    443 ssl;
        server_name www.cyanzoy.top;
        # ssl on;
        # root /mnt/project/blog/MAOA-L.github.io/;
        # index index.html index.htm;
        ssl_certificate   /usr/local/nginx/cert/2880038_www.cyanzoy.top.pem;
        ssl_certificate_key  /usr/local/nginx/cert/2880038_www.cyanzoy.top.key;
        ssl_session_timeout 5m;
        # ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;
        ssl_ciphers  HIGH:!aNULL:!MD5;
        # ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
        ssl_prefer_server_ciphers on;
        location / {
            root /mnt/project/blog/MAOA-L.github.io/;
            index index.html index.htm;
        }
    }

}

</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ‰£å‡åº“å­˜]]></title>
        <id>https://www.cyanzoy.top/post/UL3LlJVMC</id>
        <link href="https://www.cyanzoy.top/post/UL3LlJVMC">
        </link>
        <updated>2019-09-18T03:24:31.000Z</updated>
        <content type="html"><![CDATA[<!-- more -->
<p>ä½¿ç”¨CAS, <code>update table set v_1 = aa where id = xx and v_1 = old_v_1</code></p>
<blockquote>
<p>CAS â˜ compare/check and swap/set</p>
</blockquote>
<p>ä¸Šé¢çš„æ–¹æ¡ˆ,å¯èƒ½ä¼šå‡ºç°ä¸€ä¸ªCASä¸­ç»å…¸é—®é¢˜. ABAçš„é—®é¢˜.</p>
<pre><code>ABAæ˜¯æŒ‡:
çº¿ç¨‹T1 æŸ¥è¯¢,åº“å­˜å‰©ä½™ Â 100
çº¿ç¨‹T2 æŸ¥è¯¢,åº“å­˜å‰©ä½™ Â 100
çº¿ç¨‹T1 æ‰§è¡Œsubupdate t set surplus = 90 where id = x and surplus = 100;
çº¿ç¨‹T3 æŸ¥è¯¢, åº“å­˜å‰©ä½™ 90
çº¿ç¨‹T3 æ‰§è¡Œadd Â update t set surplus = 100 where id = x and surplus = 90;
çº¿ç¨‹T2 æ‰§è¡Œsubupdate t set surplus = 90 where id = x and surplus = 100;
</code></pre>
<p>è¿™é‡Œçº¿ç¨‹T2æ‰§è¡Œçš„æ—¶å€™,åº“å­˜çš„100å·²ç»ä¸æ˜¯æŸ¥è¯¢åˆ°çš„100äº†<br>
ä¸€èˆ¬çš„è®¾è®¡ä¸­CASä¼šä½¿ç”¨versionæ¥æ§åˆ¶.</p>
<pre><code>update t set surplus = 90 ,version = version+1 where id = x and version = oldVersion;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Git ç¬”è®°]]></title>
        <id>https://www.cyanzoy.top/post/git-bi-ji</id>
        <link href="https://www.cyanzoy.top/post/git-bi-ji">
        </link>
        <updated>2019-09-17T14:29:28.000Z</updated>
        <summary type="html"><![CDATA[<p>gitçš„ä¸€äº›å‘½ä»¤è®°å½•</p>
]]></summary>
        <content type="html"><![CDATA[<p>gitçš„ä¸€äº›å‘½ä»¤è®°å½•</p>
<!-- more -->
<p>ğŸ”¹Git æ·»åŠ è¿œç¨‹ä»“åº“å…³è”</p>
<pre><code>git remote add origin git@github.com:MAOA-L/AliPayApplet.git
git push -u origin master 
#è¿™å¥ä¸€èˆ¬ä¸ä¸Šå¥ä¸€èµ·ç”¨ã€‚ç”¨äºè¿œç¨‹ä»“åº“æ²¡æœ‰åˆå§‹åŒ–æ—¶
</code></pre>
<p>ğŸ”¸Git æœ¬åœ°åˆ†æ”¯å…³è”è¿œç¨‹åˆ†æ”¯</p>
<pre><code>git branch --set-upstream-to=origin/remote_branch  your_branch
</code></pre>
<p>ğŸ”¹Git åˆ é™¤æœ¬åœ°åˆ†æ”¯</p>
<pre><code>git branch -d [branchname]
</code></pre>
<p>ğŸ”¸Git åˆ é™¤è¿œç¨‹åˆ†æ”¯</p>
<pre><code>git push origin --delete [branchname]
</code></pre>
<blockquote>
<p><code>Q&amp;A</code><br>
ğŸ§: git branch ä¸æ˜¾ç¤ºåˆ†æ”¯åŸå› <br>
ğŸ¤ª: git branchè¦åœ¨git commitåæ‰ä¼šæ˜¾ç¤ºåˆ†æ”¯.<br>
ğŸ§:nginxçš„locationã€rootã€aliasæŒ‡ä»¤ç”¨æ³•å’ŒåŒºåˆ«<br>
ğŸ¤ª:</p>
</blockquote>
]]></content>
    </entry>
</feed>